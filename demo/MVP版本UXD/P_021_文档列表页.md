### **文档列表页 (ID: P_021)**

#### 1. 页面目标与核心功能 (Page Objectives & Core Functionality)
*   **主要目的:** 此页面是知识运营专员的**核心工作台**，用于管理单个知识库内的所有文档。其目标是提供清晰的文档概览，并赋能用户高效地执行文档的全生命周期管理操作，包括上传、更新、状态变更和删除。
*   **解决的用户痛点/目标:**
    *   直接响应 `KB-MAN-001`：“按层级清晰地浏览...快速定位到需要管理的内容”。
    *   是实现 `KB-MAN-004` (文档生命周期管理) 和 `KB-MAN-005` (权限控制) 的主要界面。
    *   满足用户“上传一个文档文件”、“对整个‘文档’进行启用、禁用或删除操作”的核心需求。
*   **在用户旅程中的角色:** 在“**旅程 1: 评估驱动的知识优化闭环**”中，这是**第二步**，是知识“生产”和“维护”的核心操作界面。用户在此页面完成文档的增删改，然后才能进入下一层查看和编辑具体的知识条目。

#### 2. 设计方案探索 (Design Options - Wireframes & Rationale)

*   **ASCII + Emoji 线框图 (方案 A):**
    ```
    +-----------------------------------------------------------------------------------+
    | [Global Navigation Sidebar]                                                       |
    |                                                                                   |
    |  +------------------------------------------------------------------------------+ |
    |  | 🍞 知识库 > 📘 产品A手册                                                      | |
    |  |                                                                              | |
    |  | <h1>📘 产品A手册</h1>                                                       | |
    |  |                                                                              | |
    |  | [🔍 按文档名称搜索... ]                         [ + 📤 上传文档 ]               | |
    |  |                                                                              | |
    |  |  <!-- 当有条目被选中时，浮现此批量操作栏 -->                                  | |
    |  |  | [ **2** 已选择 | ✅ 启用 | 🚫 禁用 | 🗑️ 删除 | 取消 ]                         | |
    |  |                                                                              | |
    |  |  +--------------------------------------------------------------------------+ |
    |  |  | [ ] | 文档名称 ⌄    | 状态      | 快速启用/禁用 | 🧩 知识条目数 | 🕒 上传时间      | 🕒 最后更新      | 操作     | |
    |  |  |-----|---------------|-----------|---------------|---------------|------------------|------------------|----------| |
    |  |  | [x] | ➡️ 安装指南.md |🟢 已启用  |   [🔘 ON ]    |      150      | 3天前            | 2天前, by 小张   | ⚙️ 🗑️    | |
    |  |  |-----|---------------|-----------|---------------|---------------|------------------|------------------|----------| |
    |  |  | [x] | ➡️ 功能列表.txt |🟢 已启用  |   [🔘 ON ]    |      88       | 1天前            | 5小时前, by 王...| ⚙️ 🗑️    | |
    |  |  |-----|---------------|-----------|---------------|---------------|------------------|------------------|----------| |
    |  |  | [ ] | ➡️ API参考.md  |🔴 已禁用  |   [⚪️ OFF]    |      230      | 2周前            | 1周前, by 李工   | ⚙️ 🗑️    | |
    |  |  +--------------------------------------------------------------------------+ |
    |  |                                                                              | |
    |  |                                                      [ << < 1 2 > >> ]          | |
    |  +------------------------------------------------------------------------------+ |
    +-----------------------------------------------------------------------------------+
    ```

*   **设计理念与特点 (方案 A):**
    *   **布局原则与区域划分:** 采用经典的**数据表格 (Data Table)** 布局，这是管理大量条目数据的最有效方式。页面布局清晰：头部包含面包屑导航、标题和主操作按钮；内容区是可排序、可筛选的数据表格；底部包含批量操作和分页。
    *   **信息组织与内容呈现:**
        *   **核心理念:** 效率至上。遵循【效率与清晰】原则，将所有文档的关键属性（状态、条目数、更新时间）以列对齐，方便用户快速扫描、排序和比较。
        *   **设计选择:** 状态（🟢 已启用 / 🔴 已禁用）使用“图标+文字”的形式，既直观又清晰。为未来的批量操作预留了复选框。
    *   **关键UI组件选择:**
        *   **数据表格:** 支持按列排序，是处理结构化数据的最佳选择。
        *   **面包屑导航:** `🍞 知识库 > 📘 产品A手册`，这是我们架构中的关键组件，确保用户始终了解自己所处的位置，并能快速返回上一级，遵循【可用性】原则。
        *   **操作列 (Actions):** 将“启用/禁用”(在⚙️设置菜单内)和“删除”(🗑️)等高频操作直接放在行内，方便快速访问。
    *   **页面级导航逻辑:** 用户点击文档名称 `➡️ 安装指南.md`，导航至该文档的“知识条目列表页 (`P_022`)”。点击面包屑中的“知识库”则返回 `P_020`。
    *   **与全局策略的关联:** 完美契合“左侧边栏 + 页面头部 + 主内容区”的全局策略。
    *   **优缺点简析:**
        *   **优点:** 信息密度极高，扫描和排序效率一流，支持批量操作，非常适合需要管理海量文档的“电力用户”。
        *   **缺点:** 对于文档数量少的场景可能显得过于正式和密集，视觉上不如卡片式友好。


#### 3. 功能区描述与数据展示逻辑 (Feature Area Description & Data Display Logic)

*   **整体内容策略与信息层级:**
    *   **核心思想:** 以**任务为导向**，为知识运营专员提供一个高效、清晰、可控的管理界面。
    *   **信息优先级:**
        1.  **第一优先级 (核心识别与状态):** 文档名称、文档状态。用户需要一眼看出这是什么文档，以及它是否在线上生效。
        2.  **第二优先级 (关键元数据):** 最后更新时间、知识条目数。这为用户判断文档的“新鲜度”和“体量”提供了关键依据。
        3.  **第三优先级 (操作入口):** 行内操作与批量操作。

*   **功能区域详解:**
    *   **区域1: 页面头部 (Header)**
        *   **位置:** 页面主内容区顶部。
        *   **目的:** 提供上下文定位和页面标题。
        *   **包含元素:** `🍞 面包屑导航`, `<h1> 页面大标题`。
    *   **区域2: 操作栏 (Action Bar)**
        *   **位置:** 页面标题下方。
        *   **目的:** 提供全局搜索和核心“创建”入口。
        *   **包含元素:** `🔍 搜索框`, `+ 📤 上传文档` 按钮。
    *   **区域3: 数据表格 (Data Table)**
        *   **位置:** 页面核心区域。
        *   **目的:** 以结构化方式展示所有文档及其关键属性，是信息浏览和操作的主要载体。
        *   **包含元素:** 表头（支持排序）、数据行（带复选框）、行内操作。
    *   **区域4: 表格页脚 (Table Footer)**
        *   **位置:** 数据表格下方。
        *   **目的:** 提供批量操作的入口和列表分页功能。
        *   **包含元素:** `批量操作区`, `分页组件`。

*   **核心数据字段与展示逻辑:**
    *   **文档列表项 (Data Table Row):**
        *   **显示字段:**
            *   `复选框`: 用于批量选择。
            *   `文档名称`: 显示文件名。作为链接，点击后导航至 `P_022_知识条目列表页`。
            *   `状态`: **关键字段**。使用“图标+文字”标签，直观展示文档当前生命周期阶段。
                *   `🟢 已启用`: 文档及其知识条目可被AI应用检索和使用。
                *   `🔴 已禁用`: 文档及其知识条目**不会**被AI应用检索和使用，但数据保留在库中。
            *   `快速启用/禁用`: 提供一个开关（Toggle Switch），允许用户在不进入菜单或页面的情况下，快速切换单个文档的启用/禁用状态。这是对高频操作的优化，遵循【效率与清晰】原则。
            *   `知识条目数`: 显示该文档成功解析出的知识条目数量。
            *   `上传时间`:  显示文档首次上传的时间。
            *   `最后更新`: 显示“时间 + by 用户”的格式，追溯变更历史。
            *   `操作`: 包含 `⚙️ 设置` 和 `🗑️ 删除` 两个图标按钮。

---

#### 4. 交互行为与用户流 (Interaction Behaviors & User Flows)

*   **核心用户操作流 1: 上传或更新文档** (`KB-MAN-004`)
    1.  **意图与起点:** 用户小张需要上传一份产品说明文档 `新功能.md`。他已进入“产品A手册”知识库的“文档列表页” (`P_021`)。
    2.  **触发动作 (UI元素):** 小张点击页面右上角的 `[ + 📤 上传文档 ]` 按钮。
    3.  **系统反馈 (UI元素):** 系统弹出一个模态框（“文档上传器” `P_012`）。
    4.  **用户交互:** 小张将 `新功能.md` 文件拖拽到上传区域。
    5.  **系统反馈与智能判断:**
        *   前端进行格式和大小校验。
        *   **核心逻辑：** 前端根据文件名 `新功能.md` **立即检查当前知识库中是否存在同名文档**。
        *   **情况 A (新文档):** 如果不存在同名文档。
            *   模态框标题和提示信息明确为 **“上传新文档”**。
            *   用户点击“确认上传”后，系统调用 **Dify 创建文档接口**。
            *   上传成功并解析完毕后，主列表刷新，`新功能.md` 出现在列表中，状态为 `🟢 已启用`。
            *   右下角弹出成功轻提示：“文档‘新功能.md’已成功上传。”
        *   **情况 B (更新文档):** 如果已存在同名文档 `新功能.md`。
            *   模态框标题和提示信息明确为 **“更新现有文档”**，并附带警告：“文件 `新功能.md` 已存在，继续上传将覆盖现有内容。”
            *   用户点击“确认更新”后，系统调用 **Dify 更新文档接口**。
            *   更新成功并解析完毕后，主列表刷新，`新功能.md` 的“最后更新”时间等信息被更新。
            *   右下角弹出成功轻提示：“文档‘新功能.md’已成功更新。”
    6.  **异常处理:** 若API调用失败，遵循【**容错性**】原则，弹框内会显示明确的错误提示（如“上传失败，请检查文件格式或联系管理员”），并允许用户重试。

*   **核心用户操作流 2: 批量禁用文档** (`KB-MAN-004`, `KB-MAN-005`)
    1.  **意图与起点:** 王经理需要将几份已过时的文档批量禁用。
    2.  **触发动作 (UI元素):** 他点击表格第一列的复选框 `[ ]`，选中了“旧版API参考.md”和“历史活动说明.txt”。
    3.  **系统反馈 (UI元素):**
        *   每点击一个复选框，其变为选中状态 `[✅]`。
        *   当第一个条目被选中时，页面表格上方**平滑浮现**出“批量操作栏”，并显示 `[ **1** 已选择 | ... ]`。
        *   随着选择数量增加，数字实时更新为 `[ **2** 已选择 | ... ]`。
    4.  **用户交互与提交 (UI元素):** 王经理点击批量操作栏中的 `[🚫 禁用]` 按钮。
    5.  **系统反馈与完成:**
        *   系统弹出“确认对话框” (`P_013`)，提示：“您确定要禁用选中的2个文档吗？禁用后，相关的知识条目将无法被AI应用检索。”
        *   确认后，被选中的两个文档在列表中的状态立即更新为 `(🔴 已禁用)`。
        *   批量操作栏消失，列表恢复到普通状态。
        *   右下角弹出成功轻提示：“2个文档已成功禁用。”

*   **核心用户操作流 3: 批量删除文档** (`KB-MAN-004`)
    1.  **意图与起点:** 李工需要将几份完全废弃的文档批量删除。
    2.  **触发动作 (UI元素):** 他点击表格第一列的复选框 `[ ]`，选中了“废弃功能A.md”和“临时测试.txt”。
    3.  **系统反馈 (UI元素):**
        *   每点击一个复选框，其变为选中状态 `[✅]`。
        *   当第一个条目被选中时，页面表格上方**平滑浮现**出“批量操作栏”，并显示 `[ **1** 已选择 | ... ]`。
        *   随着选择数量增加，数字实时更新为 `[ **2** 已选择 | ... ]`。
    4.  **用户交互与提交 (UI元素):** 李工点击批量操作栏中的 `[🗑️ 删除]` 按钮。
    5.  **系统反馈与完成:**
        *   系统弹出“确认对话框” (`P_013`)，提示：“**危险操作：**您确定要**永久删除**选中的2个文档吗？此操作不可恢复。” 遵循【容错性】原则，删除操作的确认提示应使用更强的警告语气。
        *   确认后，被选中的两个文档从列表中消失。
        *   批量操作栏消失。
        *   右下角弹出成功轻提示：“2个文档已成功删除。”

*   **关键交互与反馈:**
    *   **行内操作菜单 (⚙️):** 点击行内的设置图标 `⚙️`，会弹出一个小型的下拉菜单（Dropdown Menu），包含 **“更新文档”、“重命名”** 等次级操作。点击“更新文档”会直接打开文件选择器，让用户选择新版本的文件进行覆盖更新，后续流程与“核心用户操作流 1”中的“情况 B (更新文档)”一致（**需要检查文件名是否一致**）。
    *   **删除操作 (🗑️):** 点击删除图标 `🗑️`，会立即触发“确认对话框” (`P_013`)，进行二次确认，防止误操作，这是【**容错性**】原则的体现。
    *   **排序:** 点击表头的 `文档名称 ⌄` 或 `🕒 最后更新 ⌄`，表格会根据该列进行升序/降序排列，并在表头显示排序方向的箭头图标。

*   **状态变化:**
    *   **页面加载中:** 与 `P_020` 类似，页面加载时显示**骨架屏**。骨架屏应模仿表格的结构：一个标题行和几行灰色占位行，每行包含几个长短不一的矩形，模拟单元格内容。
    *   **列表为空:** 如果该知识库下没有任何文档，表格区域将显示一个友好的空状态视图，包含：
        *   插图：一个空的文件夹图标。
        *   标题：“这个知识库还没有文档”。
        *   引导文字：“点击右上角的“上传文档”按钮，开始添加您的第一个文档吧！”
        *   一个醒目的 `[ + 📤 上传文档 ]` 按钮。
    *   **搜索无果:** 表格显示“未找到与‘[搜索词]’相关的文档”，并提供一个“清除搜索条件”的链接。

*   **错误处理与容错性:**
    *   **场景1: 单个操作失败 (如禁用失败):**
        *   **处理方式:** 如果用户通过行内操作禁用单个文档时API调用失败，系统应在当前行附近或通过轻提示显示错误信息：“操作失败，请重试。”，而不是刷新整个页面。表格行应恢复到操作前的状态。
    *   **场景2: 批量操作部分失败:**
        *   **处理方式:** 这是一个复杂但常见的情况。如果批量禁用3个文档，2个成功1个失败。操作完成后，表格应刷新，成功禁用的2个文档状态更新。同时，页面顶部应出现一个**持久化**的提示条（Alert Banner），内容为：“批量操作已完成，但有1个文档操作失败。查看详情。” 点击“查看详情”可以高亮显示失败的行或弹出列表。这提供了精确的【**反馈**】。