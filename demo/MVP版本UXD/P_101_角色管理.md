### P_101: 角色管理 (ID: P_101)

#### 1. 页面目标与核心功能 (Page Objectives & Core Functionality)
*   **页面目的:** 为系统管理员提供一个集中、高效的平台，用于创建、配置和管理用户角色及其权限，确保系统资源的访问安全可控。
*   **解决用户痛点:** 解决 `FEAT-KM-104` 中定义的权限管理需求，将复杂的权限逻辑以清晰、直观的方式呈现，降低管理员的管理成本和出错风险。
*   **用户旅程角色:** 在“系统设置与维护”用户旅程中，此页面是实现基于角色的访问控制 (RBAC) 的核心操作界面。

#### 2. 设计方案探索 (Design Options - Wireframes & Rationale)

**方案: 两栏式高效布局 (Two-Column Power Layout)**

*   **ASCII + Emoji 线框图 :**
```
+--------------------------------------------------------------------------------------+
| 角色管理                                                                  [+ 新建角色] |
+--------------------------------------------------------------------------------------+
| [搜索角色...]                                                                           |
|--------------------------|-------------------------------------------------------------|
| 角色列表 (Roles) 📜       | 权限配置 (Permissions) ⚙️                                     |
|--------------------------|-------------------------------------------------------------|
| 🔘 系统管理员 (内置)       | ▼ 知识库模块 (全选)                                             |
| 🔘 知识库A管理员 (选中)     |   ▶︎ 知识库管理                                                |
| 🔘 知识库A管理员 (选中)     |     [✅] 查看知识库                                           |
| 🔘 ...                   |     [✅] 上传文档                                             |
|                          |     [❌] 删除知识库                                           |
|                          |   ▶︎ 文档 (部分选中)                                         |
|                          |   ▶︎ 知识条目 (未选)                                         |
|                          | ▼ Prompt 工程 (部分选中)                                    |
|                          |   [✅] Prompt 开发                                          |
|                          |   [ ] Playground                                            |
|                          | ▼ 评测 (未选)                                               |
|                          |   [ ] 评测集                                                |
|                          |   [ ] 评估器                                                |
|                          |   [ ] 实验                                                  |
|                          | ▼ 观测 (未选)                                               |
|                          |   [ ] Trace                                                 |
|                          |   [ ] 统计                                                  |
|                          |   [ ] 自动化任务                                            |
|                          | ▼ 模型 (未选)                                               |
|                          |   [ ] 模型管理                                              |
|                          | ▼ MCP (未选)                                                |
|                          |   [ ] MCP服务                                               |
+--------------------------------------------------------------------------------------+
```

*   **设计理念与特点 :**
    *   **布局原则与区域划分:** 采用经典的两栏式布局，左侧为**角色列表**，右侧为**权限配置**。这种布局遵循了从“选择对象”到“配置细节”的自然操作心流，逻辑清晰，聚焦于角色和权限的核心关系。
    *   **信息组织与内容呈现:** 将两大核心功能并置于同一视图内，管理员可以一目了然地看到角色及其权限的完整信息，无需任何页面跳转，实现了【**效率与清晰**】。
    *   **关键UI组件选择:**
        *   **角色列表:** 使用单选列表，清晰地标示当前正在操作的角色。
        *   **权限配置:** 使用**树形控件 (Tree)** 来组织层级化的权限。树状结构能非常直观地反映权限间的父子关系。
    *   **页面级导航逻辑:** 整个页面的所有核心操作都在视图内完成。点击左侧的角色，右侧权限配置栏的内容会相应更新。

#### 3. 功能区描述与数据展示逻辑 (Feature Area Description & Data Display Logic)

*   **整体内容策略与信息层级:**
    *   **核心思想:** 聚焦于角色权限的配置。管理员无需跳转即可在一个屏幕内完成“选择角色 → 配置权限”的核心工作流。
    *   **信息优先级:** 1. 当前选中的角色是谁。 2. 该角色的权限配置详情。

*   **功能区域详解:**
    *   **区域1: 角色列表 (Roles) - 左栏**
        *   **目的:** 展示系统中所有的角色，并允许管理员进行选择、搜索和创建。
        *   **包含元素:** 新建角色按钮, 搜索框, 角色列表项 (内置角色和自定义角色)。
    *   **区域2: 权限配置 (Permissions) - 右栏**
        *   **目的:** 详细展示并允许编辑当前选中角色的权限。
        *   **包含元素:** 权限树 (Permission Tree)，支持展开/折叠、联动选择和依赖关系处理。

*   **核心数据字段与展示逻辑:**
    *   **角色 (Role):** `角色名称`, `(内置)` 标签。
    *   **权限 (Permission):** `权限名称`, `权限状态 (允许/禁止)`。

---

#### 4. 交互行为与用户流 (Interaction Behaviors & User Flows)

*   **核心用户操作流:**
    *   **操作1: 创建并配置一个新角色**
        1.  **意图与起点:** 管理员希望创建一个“市场部专员”角色。
        2.  **触发动作:** 点击 `+ 新建角色` 按钮。
        3.  **用户输入与交互:** 弹出模态框，输入角色名称和描述。
        4.  **系统反馈:** 新角色出现在列表中并被选中，右侧加载默认权限。
        5.  **配置权限:** 管理员在中栏的权限树中勾选所需权限。
        6.  **后置结果:** “市场部专员”角色创建完成。
    *   **操作2: 修改现有角色的权限**
        1.  **意图与起点:** 给现有角色增删权限。
        2.  **触发动作:** 在左栏角色列表中选择目标角色。
        3.  **系统反馈:** 右栏更新为该角色的当前权限。
        4.  **用户输入与交互:** 在权限树中修改勾选。
        5.  **提交与反馈:** 权限更改自动实时保存，并给出短暂的成功提示。

*   **关键交互与反馈:**
    *   **切换角色:** 点击角色列表项，右栏内容加载并更新。
    *   **权限开关:** 点击复选框立即改变状态并自动保存。
    *   **删除角色:** 点击删除图标，弹出二次确认模态框，体现【**容错性**】。

*   **状态变化:**
    *   **页面加载:** 内容区显示骨架屏。
    *   **角色列表为空:** 显示友好提示和引导操作。

*   **错误处理与容错性:**
    *   **API请求失败:** 在对应区域显示错误提示和“重试”按钮。