### **知识条目列表页 (ID: P_022)**

#### 1. 页面目标与核心功能 (Page Objectives & Core Functionality)
*   **主要目的:** 此页面的核心目标是清晰、有序地展示**单个文档**解析后生成的所有知识条目。它使用户能够快速浏览、搜索特定内容，并方便地定位到需要修改的条目，最终触发编辑操作。
*   **解决的用户痛点/目标:**
    *   这是 `KB-MAN-001` (知识库结构浏览) 的最后一层，让用户能够“按层级...导航至指定的知识条目”。
    *   是 `KB-MAN-002` (知识条目内容查看) 和 `KB-MAN-003` (创建/编辑知识条目) 的**发起点**。用户在此找到目标条目后，才能进行查看和编辑。
*   **在用户旅程中的角色:** 在“**旅程 1: 评估驱动的知识优化闭环**”中，这是知识更新流程的**第三步**。用户在此页面完成对具体知识片段的定位，这是发起精准内容修正的前提。

#### 2. 设计方案探索 (Design Options - Wireframes & Rationale)

*   **ASCII + Emoji 线框图:**
    ```
    +-----------------------------------------------------------------------------------+
    | [Global Navigation Sidebar]                                                       |
    |                                                                                   |
    |  +------------------------------------------------------------------------------+ |
    |  | 🍞 知识库 > 📘 产品A手册 > 📄 安装指南.md                                      | |
    |  |                                                                              | |
    |  | <h1>📄 安装指南.md</h1>                                                      | |
    |  | <small>包含 150 个知识条目・最后更新于 2天前</small>                             | |
    |  |                                                                              | |
    |  | [ 在150个条目中搜索... ]   [ + 新建知识条目 ] [ 🟢 文档已启用 🔛 ] [ ... ] | |
    |  |                                                                              | |
    |  | <!-- Conditional Bulk Action Bar: Appears when one or more items are selected --> |
    |  | [ **2** 已选择 | | ✅ 启用 | 🚫 禁用 | 🗑️ 删除 | 取消 ]                         | |
    |  |                                                                              | |
    |  | +----------------------------------------------------------------------------+ |
    |  | | [ ] <small>内容片段: "在安装前，请确保您的操作系统为 Windows 10..."</small>  (🟢 已启用) [ 🔛 | ✏️ | 🗑️ ] |
    |  | +----------------------------------------------------------------------------+ |
    |  | | [ ] <small>内容片段: "下载最新的 .exe 安装包..."</small>                 (🟢 已启用) [ 🔛 | ✏️ | 🗑️ ] |
    |  | +----------------------------------------------------------------------------+ |
    |  | | [ ] <small>内容片段: "首先，请确保您已安装 Homebrew..."</small>            (🔴 已禁用) [ 🔛 | ✏️ | 🗑️ ] |
    |  | +----------------------------------------------------------------------------+ |
    |  |                                                                              | |
    |  |                                     [ << < 1 2 ... 15 > >> ]                   | |
    |  +------------------------------------------------------------------------------+ |
    +-----------------------------------------------------------------------------------+
    ```

*   **设计理念与特点:**
    *   **布局原则与区域划分:** 采用分层管理设计。核心区域分为：**文档级全局操作区**（搜索、新建、更多操作）、**批量操作区**（条件触发）、**内容列表区**和**分页区**。
    *   **信息组织与内容呈现:**
        *   **核心理念:** 确保操作的直接性和可见性，简化信息结构。遵循【**效率与清晰**】和【**容错性**】原则。
        *   **设计选择:**
            *   **无标题内容:** 知识条目不再区分标题和内容，直接展示核心内容片段，简化了信息层级。
            *   **直接操作 (Direct Actions):** 移除所有悬停交互。单个条目的所有操作（状态开关、编辑、删除）始终可见，提升了操作效率和在触摸设备上的可用性。
            *   **状态可视化:** 每个条目明确展示其独立的启用 `(🟢 已启用)` 或禁用 `(🔴 已禁用)` 状态。
            *   **文档级“更多”菜单:** 在“新建”按钮旁增加“...”菜单，用于处理针对当前文档本身的全局性任务（如：重命名、删除文档）。
    *   **关键UI组件选择:**
        *   **条目级状态开关 (Item-level Status Toggle):** 每个条目行内独立的开关，用于精细化控制单个条目的状态。
        *   **条件式批量操作栏:** 当用户选择条目时出现，提供批量“启用”、“禁用”、“删除”功能。
        *   **文档级状态总开关 (Document-level Status Toggle):** 一个位于全局操作区的总开关，用于一键启用/禁用当前文档下的所有知识条目。
        *   **文档级更多菜单:** 页面顶部的“...”按钮，点击后以下拉菜单形式提供文档级操作。
    *   **页面级导航逻辑:**
        *   点击 `[ ✏️ 编辑 ]` 打开“知识条目编辑器” (`P_011`) 模态框。
        *   **双击**条目文本区域，直接在当前页面以模态框形式打开“知识条目编辑器” (`P_011`) 进行快捷编辑。
    *   **与全局策略的关联:** 遵循全局布局策略，通过简化条目信息结构和提供直接操作，优化了管理效率。

#### 4. 功能区描述与数据展示逻辑 (Feature Area Description & Data Display Logic)

*   **整体内容策略与信息层级:**
    *   **第一优先级:** 知识条目的核心内容片段和状态（启用/禁用）。
    *   **第二优先级:** 单个条目的直接操作（状态开关、编辑、删除）和批量操作能力。
    *   **第三优先级:** 文档级操作（搜索、新建、更多）和导航。

*   **功能区域详解:**
    *   **区域1: 页面标题与导航区** - **目的:** 提供页面上下文，展示当前文档信息，并提供返回上级的面包屑导航。
    *   **区域2: 全局操作区** - **目的:** 提供针对整个列表的操作，包括“搜索”和“新建知识条目”。
    *   **区域3: 批量操作栏 (条件显示)** - **目的:** 当用户选中至少一个条目时出现，提供对选中条目的批量处理能力（启用、禁用、删除）。体现【效率与清晰】原则。
    *   **区域4: 知识条目列表区** - **目的:** 核心内容展示区域，以列表形式逐条展示知识条目。
    *   **区域5: 分页控件区** - **目的:** 用于在大量条目中进行导航。

*   **核心数据字段与展示逻辑:**
    *   **文档级控件 (Document-level Controls):**
        *   **显示字段:**
            *   `document_status_toggle`: 文档级状态总开关。
            *   `document_more_menu`: 文档级更多操作菜单 (触发器为 '...' 按钮)。
        *   **展示逻辑:**
            *   `document_status_toggle`: 此开关为**主控开关**。当它被**禁用**时，该文档下的所有知识条目将**强制禁用**，且单个条目的开关变为不可操作状态。当它被**启用**时，允许单个条目恢复其各自的状态。反向逻辑：如果用户启用了**任何一个**单独的知识条目，此文档级开关必须**自动切换到启用状态**。
            *   点击 `document_more_menu` 触发器后，以下拉菜单形式展示“重命名”、“删除”等针对当前文档的操作。
            *   “删除”操作需要二次确认。

    *   **知识条目 (List Item):**
        *   **显示字段:**
            *   `selection_checkbox`: 复选框。
            *   `content_snippet`: 内容片段 (字符串, 截取前N个字符)。
            *   `item_status_label`: 知识条目状态标签 (如 `(🟢 已启用)`)。
            *   `item_actions`: 始终可见的操作组 `[ 🔛 | ✏️ | 🗑️ ]`。
        *   **展示逻辑:**
            *   `content_snippet` 作为条目的唯一识别文本。
            *   `item_status_label` 必须有明确的视觉区分。
            *   `item_actions` 始终可见，包含独立的启用/禁用开关、编辑按钮和删除按钮。

    *   **批量操作栏 (Bulk Action Bar):**
        *   **显示字段:**
            *   `selection_count`: 已选中的条目数量 (整数)。
        *   **展示逻辑:**
            *   当 `selection_count` > 0 时显示，提供批量“启用”、“禁用”、“删除”操作。

    *   **条目操作组 (Item Actions):**
        *   **包含操作:**
            *   `status_toggle`: 启用/禁用状态切换开关 `🔛`。
            *   `edit_button`: 编辑按钮 `✏️`。
            *   `delete_button`: 删除按钮 `🗑️`。
        *   **展示逻辑:**
            *   所有操作按钮始终可见，无需悬停。
            *   “删除”操作前必须有二次确认弹窗，体现【容错性】。

---

#### 5. 交互行为与用户流 (Interaction Behaviors & User Flows)

*   **核心用户操作流 1: 批量启用/禁用/删除知识条目**
    1.  **意图与起点:** 管理员小王需要将所有关于旧版操作系统的安装指南条目一次性禁用。
    2.  **触发动作 (UI元素):** 小王点击多个知识条目前面的复选框 `[ ]`。
    3.  **系统反馈 (UI元素):**
        *   每点击一个复选框，其变为选中状态 `[✅]`。
        *   当第一个条目被选中时，页面顶部（或列表上方）**平滑浮现**出“批量操作栏”，并显示 `[ **1** 已选择 | ... ]`。
        *   随着选择数量增加，数字实时更新为 `[ **3** 已选择 | ... ]`。
    4.  **用户交互与提交 (UI元素):** 小王点击批量操作栏中的 `[🚫 禁用]` 按钮。
    5.  **系统反馈与完成:**
        *   系统可能会弹出一个确认对话框：“您确定要禁用选中的3个条目吗？”。
        *   确认后，被选中的三个条目在列表中的状态立即更新为 `(🔴 已禁用)`，并可能有视觉上的变化（如文本变灰）。
        *   批量操作栏消失，列表恢复到普通状态。
        *   右下角弹出成功轻提示：“3个知识条目已成功禁用。”

*   **核心用户操作流 2: 单个条目的直接操作 (编辑/切换状态/删除)**
    1.  **意图与起点:** 用户小张发现某个知识条目中有个命令写错了，需要修改。
    2.  **触发动作 (UI元素):** 小张直接在目标条目行内找到始终可见的操作按钮组 `[ 🔛 | ✏️ | 🗑️ ]`。
    3.  **用户交互与提交 (UI元素):**
        *   **场景A (编辑):** 小张点击 `[ ✏️ ]` 按钮，或者**双击**该条目的内容片段区域。任一操作均会弹出“知识条目编辑器” (`P_011`)。
        *   **场景B (切换状态):** 小张点击 `[ 🔛 ]` 开关。该条目的状态立即在 `(🟢 已启用)` 和 `(🔴 已禁用)` 之间切换，无需确认。
        *   **场景C (删除):** 小张点击 `[ 🗑️ ]` 按钮。系统弹出二次确认对话框，体现【**容错性**】。
    4.  **系统反馈与完成:** 根据不同场景，列表项会立即刷新（状态变更、被删除），并伴有相应的成功提示。

*   **核心用户操作流 3: 文档级操作 (重命名/删除)**
    1.  **意图与起点:** 用户小李认为当前文档“安装指南.md”的名称不够清晰，想要重命名。
    2.  **触发动作 (UI元素):** 小李点击页面右上角的 `[ ... ]` 更多操作按钮。
    3.  **系统反馈 (UI元素):** 系统在按钮下方以内联下拉菜单的形式展示操作列表：`[ 重命名, 删除 ]`。
    4.  **用户交互与提交 (UI元素):**
        *   **场景A (重命名):** 小李点击“重命名”，页面标题 `<h1>` 变为一个可编辑的输入框，并自动聚焦。修改后按回车或点击外部区域即可保存。
        *   **场景B (删除):** 小李点击“删除”，系统弹出高风险操作的二次确认对话框：“您确定要删除整个文档‘安装指南.md’及其包含的150个知识条目吗？此操作不可恢复。”
    5.  **系统反馈与完成:** 操作成功后，系统给出相应提示，并可能将用户导航至上一级页面（如文档列表页）。

*   **核心用户操作流 4: 切换文档级状态**
    1.  **意图与起点:** 管理员小王希望临时禁用整个“安装指南.md”文档的所有知识，以便进行集中修改，避免被AI调用。
    2.  **触发动作 (UI元素):** 小王点击全局操作区的文档级状态总开关 `[ 🟢 文档已启用 🔛 ]`。
    3.  **系统反馈 (UI元素):**
        *   开关状态切换为 `[ 🔴 文档已禁用 🔛 ]`。
        *   列表中的**所有**知识条目状态立即同步更新为 `(🔴 已禁用)`，并且整行变灰，行内的独立开关 `[ 🔛 ]` 变为不可点击状态。
    4.  **用户交互与提交 (UI元素):**
        *   **场景A (重新启用文档):** 小王再次点击总开关。总开关变为 `[ 🟢 文档已启用 🔛 ]`，所有条目恢复到其**各自之前**的状态（之前是启用的就恢复启用，之前是禁用的仍然禁用），行内开关恢复可操作。
        *   **场景B (单个启用反向同步):** 当文档级开关为启用状态时，如果用户手动禁用了所有条目，然后启用了其中**任何一个**条目，文档级开关必须保持/自动切换为 `[ 🟢 文档已启用 🔛 ]` 状态。
    5.  **系统反馈与完成:** 操作立即生效，并伴有轻提示，如“‘安装指南.md’已禁用”。

*   **关键交互与反馈:**
    *   **批量操作栏:** 出现和消失应有平滑的过渡动画，避免突兀。点击“取消”或取消所有选中项时，该栏消失。
    *   **直接操作:** 所有核心操作（启用/禁用、编辑、删除）都作为独立按钮始终可见，无需悬停或额外点击。

*   **状态变化:**
    *   **页面加载中:** 显示**骨架屏**。骨架屏应模仿新的列表项结构：每行包含一个方块（模拟复选框）、一个长矩形（模拟内容片段）和右侧三个小方块（模拟操作按钮）。
    *   **条目禁用状态:** 禁用的条目整行文本颜色应变浅（如灰色），以在视觉上与启用状态区分。
    *   **列表为空 / 搜索无果:** 处理方式同原方案。

*   **错误处理与容错性:**
    *   **场景1: 批量操作失败:**
        *   **处理方式:** 如果点击批量操作栏的“删除”后，部分条目因权限等原因删除失败，系统应在操作完成后给出明确反馈，如一个包含详细信息的提示：“2个条目已删除，1个条目因正在使用无法删除。”
    *   **场景2: 保存编辑失败 / 获取内容失败:** 处理方式同原方案，在模态框内或操作控件旁给出即时反馈，不中断用户流程。
